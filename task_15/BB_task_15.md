# Задача о максимальном потоке минимальной стоимости.
Для каждого варианта представлены условия задачи, в соответствии с которыми необходимо: 
1. Построить сеть с указанием пропускной способности дуг.
2. Построить остаточную сеть.
3. Определить максимальный поток методом поиска увеличивающих путей в остаточной сети.
4. Минимизировать стоимость максимального потока посредством поиска циклов отрицательной стоимости.
5. Оформить решение задачи по шагам с подробными комментариями, таблицами и диаграммами.
6. В ответе указать максимальную величину потока, минимальную стоимость и сеть с указанием соответствующих локальных потоков.

### Вариант 9:

| Дуги                      | sa | sс | ab | ac | cb | bd | de | be | ce | et |
|:--------------------------|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
| Пропускная способность    | 8  | 8  | 7  | 3  | 6  | 6  | 5  | 5  | 12 | 12 |
| Стоимость транспортировки | 1  | 1  | 2  | 1  | 1  | 2  | 2  | 5  | 7  | 1  |

### 1. Построим сеть с источником **s**, стоком **t** и указанными пропускными способностями дуг для поиска максимального потока.

```mermaid
graph LR
    s-->|8|a
    s-->|8|c
    a-->|7|b
    a-->|3|c
    c-->|6|b
    b-->|6|d
    d-->|5|e
    b-->|5|e
    c-->|12|e
    e-->|12|t
```
Построим остаточную сеть
```mermaid
graph LR
    a-.->|8|s
    c-.->|8|s
    b-.->|7|a
    c-.->|3|a
    b-.->|6|c
    d-.->|6|b
    e-.->|5|d
    e-.->|5|b
    e-.->|12|c
    t-.->|12|e
```
Возьмем увеличивающий путь t->e->d->b->a->s. Минимальный вес по пути составляет 5. Вычтем его из пути и составим остаточную сеть
```mermaid
graph LR
    a-.->|3|s
    s-->|5|a
    c-.->|8|s
    b-.->|2|a
    a-->|5|b
    c-.->|3|a
    b-.->|6|c
    d-.->|1|b
    b-->|5|d
    d-->|5|e
    e-.->|5|b
    e-.->|12|c
    t-.->|7|e
    e-->|5|t
```
Возьмем увеличивающий путь t->e->->c->s. Минимальный вес составляет по пути 7. Вычтем его из пути и составим остаточную сеть
```mermaid
graph LR
    a-.->|3|s
    s-->|5|a
    c-.->|1|s
    s-->|7|c
    b-.->|2|a
    a-->|5|b
    c-.->|3|a
    b-.->|6|c
    d-.->|1|b
    b-->|5|d
    d-->|5|e
    e-.->|5|b
    e-.->|5|c
    c-->|7|e
    e-->|12|t
```
### 2. Продолжим поиск увеличивающего пути в остаточной сети

В остаточной сети не найдено увеличивающих путей, следовательно, алгоритм завершил работу и найденный поток величиной 7 является максимальным для данной сети.

```mermaid
graph LR
    s-->|5,8|a
    s-->|7,8|c
    a-->|5,7|b
    a-->|0,3|c
    c-->|0,6|b
    b-->|5,6|d
    d-->|5,5|e
    b-->|0,5|e
    c-->|7,12|e
    e-->|12,12|t
```

### 3. Рассчитаем стоимость полученного максимального потока.

| Дуги                                          | sa | sс | ab | ac | cb | bd | de | be | ce | et | Итого   |
|:----------------------------------------------|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:-------:|
| Пропускная способность p(e)                   | 8  | 8  | 7  | 3  | 6  | 6  | 5  | 5  | 12 | 12 |         |
| Локальный поток f(e)                          | 5  | 7  | 5  | 0  | 0  | 5  | 5  | 0  | 7  | 12 |         |
| Стоимость транспортировки единицы потока c(e) | 1  | 1  | 2  | 1  | 1  | 2  | 2  | 5  | 7  | 1  |         |
| Суммарная стоимость f(e)*c(e)                 | 5  | 7  | 10 | 0  | 0  | 10 | 10 | 0  | 49 | 12 | **103** |

### 4. Попробуем уменьшить стоимость потока для чего построим остаточную сеть.
Для каждого ребра остаточной сети укажем стоимость транспортировки единицы потока.

```mermaid
graph LR
    a-.->|+1|s
    s-->|-1|a
    c-.->|+1|s
    s-->|-1|c
    b-.->|+2|a
    a-->|-2|b
    c-.->|+1|a
    b-.->|+1|c
    d-.->|+2|b
    b-->|-2|d
    d-->|-2|e
    e-.->|+5|b
    e-.->|+7|c
    c-->|-7|e
    e-->|-1|t
```
В остаточной сети найден ориентированный цикл отрицательной стоимости s -> a -> b -> c -> s (-1 -2 +1 +1 = -1). 

Найдем минимальный вес ребра в указанном цикле, изображенном **в остаточной сети с указанием величины потока**.
Минимальный вес ребра в цикле 1 - это неиспользованный резерв ребра s -> c.

Удалим найденный цикл - уменьшим на 1 вес всех ребер, входящих в цикл.

```mermaid
graph LR
    a-.->|4|s
    s-->|4|a
    s-->|8|c
    b-.->|3|a
    a-->|4|b
    c-.->|3|a
    b-.->|5|c
    c-->|1|b
    d-.->|1|b
    b-->|5|d
    d-->|5|e
    e-.->|5|b
    e-.->|5|c
    c-->|7|e
    e-->|12|t
```
### 5. Проведем повторный поиск цикла отрицательной стоимости в остаточной сети.
Скорректируем остаточную сеть с указанием стоимости транспортировки единицы потока.
```mermaid
graph LR
    a-.->|+1|s
    s-->|-1|a
    s-->|-1|c
    b-.->|+2|a
    a-->|-2|b
    c-.->|+1|a
    b-.->|+1|c
    d-.->|+2|b
    b-->|-2|d
    d-->|-2|e
    e-.->|+5|b
    e-.->|+7|c
    c-->|-7|e
    e-->|-1|t
```

В остаточной сети найден ориентированный цикл отрицательной стоимости b -> c -> e -> b (+1 -7 +5 = -1). 

Найдем минимальный вес ребра в указанном цикле, изображенном **в остаточной сети с указанием величины потока**.  
Минимальный вес ребра в цикле 5 - это неиспользованный резерв ребра c -> b.

Удалим найденный цикл - уменьшим на 5 вес всех ребер, входящих в цикл.
```mermaid
graph LR
    a-.->|4|s
    s-->|4|a
    s-->|8|c
    b-.->|3|a
    a-->|4|b
    c-.->|3|a
    c-->|6|b
    d-.->|1|b
    b-->|5|d
    d-->|5|e
    b-->|5|e
    e-.->|10|c
    c-->|2|e
    e-->|12|t
```
### 6. Проведем повторный поиск цикла отрицательной стоимости в остаточной сети.
Скорректируем остаточную сеть с указанием стоимости транспортировки единицы потока.
```mermaid
graph LR
    a-.->|+1|s
    s-->|-1|a
    s-->|-1|c
    b-.->|+2|a
    a-->|-2|b
    c-.->|+1|a
    d-.->|+2|b
    b-->|-2|d
    d-->|-2|e
    e-.->|+5|b
    e-.->|+7|c
    c-->|-7|e
    e-->|-1|t
```

В остаточной сети отсутствуют циклы отрицательной стоимости, следовательно, стоимость потока минимальна.
```mermaid
graph LR
    s-->|4,8|a
    s-->|8,8|c
    a-->|4,7|b
    a-->|0,3|c
    c-->|6,6|b
    b-->|5,6|d
    d-->|5,5|e
    b-->|5,5|e
    c-->|2,12|e
    e-->|12,12|t
```

| Дуги                                          | sa | sс | ab | ac | cb | bd | de | be | ce | et | Итого   |
|:----------------------------------------------|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:-------:|
| Пропускная способность p(e)                   | 8  | 8  | 7  | 3  | 6  | 6  | 5  | 5  | 12 | 12 |         |
| Локальный поток f(e)                          | 4  | 8  | 4  | 0  | 6  | 5  | 5  | 5  | 2  | 12 |         |
| Стоимость транспортировки единицы потока c(e) | 1  | 1  | 2  | 1  | 1  | 2  | 2  | 5  | 7  | 1  |         |
| Суммарная стоимость f(e)*c(e)                 | 4  | 8  | 8  | 0  | 6  | 10 | 10 | 25 | 14 | 12 | **97** |

### Ответ:
Максимальный поток в сети равен 12, минимальная стоимость потока 97, она реализуется следующими локальными потоками:
```mermaid
graph LR
    s-->|4,8|a
    s-->|8,8|c
    a-->|4,7|b
    a-->|0,3|c
    c-->|6,6|b
    b-->|5,6|d
    d-->|5,5|e
    b-->|5,5|e
    c-->|2,12|e
    e-->|12,12|t
```
