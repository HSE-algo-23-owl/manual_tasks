# Задание №14
# Задача о максимальном потоке.
Пропускная способность дуг сети указана в таблице.
### Вариант 6:
|          Дуги          | sa | sc | ab | ad | cb | ct | bt | dt |
|:----------------------:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
| Пропускная способность | 8  | 8  | 2  | 6  | 4  | 4  | 6  | 3  |
### 1. Построим сеть с источником **s**, стоком **t** b указанными пропускными способностями дуг.
```mermaid
graph LR
    s-->|8|a
    s-->|8|c
    a-->|2|b
    a-->|6|d
    c-->|4|b
    c-->|4|t
    b-->|6|t
    d-->|3|t
```
Построим остаточную сеть. Так как изначально поток в сети не задан, все дуги сети являются пустыми (локальный поток равен нулю), соответственно в остаточную сеть необходимо вынести обратную дугу с весом равным пропускной способности. 
```mermaid
graph RL
    a-.->|8|s
    c-.->|8|s
    b-.->|2|a
    d-.->|6|a
    b-.->|4|c
    t-.->|4|c
    t-.->|6|b
    t-.->|3|d
```
### 2. Проведем поиск увеличивающего пути в остаточной сети
В остаточной сети найден увеличивающий путь t -> c -> s. Минимальный вес дуг на этом пути равен 4.
Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.
```mermaid
graph RL
    a-.->|8|s
    s--->|4|c
    c-.->|4|s
    b-.->|2|a
    d-.->|6|a
    b-.->|4|c
    c--->|4|t
    t-.->|6|b
    t-.->|3|d
```
Скорректируем соответствующим образом локальные потоки в исходной сети. Первым числом будем указывать локальный поток, вторым пропускную способность дуги. 
```mermaid
graph LR
    s-->|"(0, 8)"|a
    s-->|"(4, 8)"|c
    a-->|"(0, 2)"|b
    a-->|"(0, 6)"|d
    c-->|"(0, 4)"|b
    c-->|"(4, 4)"|t
    b-->|"(0, 6)"|t
    d-->|"(0, 3)"|t
```
### 3. Продолжим поиск увеличивающего пути в остаточной сети
```mermaid
graph RL
    a-.->|8|s
    s--->|4|c
    c-.->|4|s
    b-.->|2|a
    d-.->|6|a
    b-.->|4|c
    c--->|4|t
    t-.->|6|b
    t-.->|3|d
```
В остаточной сети найден увеличивающий путь t -> d -> a -> s. Минимальный вес дуг на этом пути равен 3.
Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.
```mermaid
graph RL
    a-.->|5|s
    s--->|3|a
    s--->|4|c
    c-.->|4|s
    b-.->|2|a
    d-.->|3|a
    a--->|3|d
    b-.->|4|c
    c--->|4|t
    t-.->|6|b
    d--->|3|t
```
Скорректируем соответствующим образом локальные потоки в исходной сети.
```mermaid
graph LR
    s-->|"(3, 8)"|a
    s-->|"(4, 8)"|c
    a-->|"(0, 2)"|b
    a-->|"(3, 6)"|d
    c-->|"(0, 4)"|b
    c-->|"(4, 4)"|t
    b-->|"(0, 6)"|t
    d-->|"(3, 3)"|t
```
### 4. Продолжим поиск увеличивающего пути в остаточной сети
```mermaid
graph LR
    a-.->|5|s
    s--->|3|a
    s--->|4|c
    c-.->|4|s
    b-.->|2|a
    d-.->|3|a
    a--->|3|d
    b-.->|4|c
    c--->|4|t
    t-.->|6|b
    d--->|3|t
```
В остаточной сети найден увеличивающий путь t -> b -> a -> s. Минимальный вес дуг на этом пути равен 2.
Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.
```mermaid
graph LR
    a-.->|3|s
    s--->|5|a
    s--->|4|c
    c-.->|4|s
    b--->|2|a
    d-.->|3|a
    a--->|3|d
    b-.->|4|c
    c--->|4|t
    t-.->|4|b
    b--->|2|t
    d--->|3|t
```
Скорректируем соответствующим образом локальные потоки в исходной сети.
```mermaid
graph LR
    s-->|"(5, 8)"|a
    s-->|"(4, 8)"|c
    a-->|"(2, 2)"|b
    a-->|"(3, 6)"|d
    c-->|"(0, 4)"|b
    c-->|"(4, 4)"|t
    b-->|"(2, 6)"|t
    d-->|"(3, 3)"|t
```
### 5. Продолжим поиск увеличивающего пути в остаточной сети
```mermaid
graph LR
    a-.->|3|s
    s--->|5|a
    s--->|4|c
    c-.->|4|s
    b--->|2|a
    d-.->|3|a
    a--->|3|d
    b-.->|4|c
    c--->|4|t
    t-.->|4|b
    b--->|2|t
    d--->|3|t
```
В остаточной сети найден увеличивающий путь t -> b -> c -> s. Минимальный вес дуг на этом пути равен 4.
Уменьшим вес дуг на найденном пути, дуги для которых вес стал нулевым удалим из остаточной сети.
```mermaid
graph LR
    a-.->|3|s
    s--->|5|a
    s--->|8|c
    b--->|2|a
    d-.->|3|a
    a--->|3|d
    c--->|4|b
    c--->|4|t
    b--->|6|t
    d--->|3|t
```
Скорректируем соответствующим образом локальные потоки в исходной сети.
```mermaid
graph LR
    s-->|"(5, 8)"|a
    s-->|"(8, 8)"|c
    a-->|"(2, 2)"|b
    a-->|"(3, 6)"|d
    c-->|"(4, 4)"|b
    c-->|"(4, 4)"|t
    b-->|"(6, 6)"|t
    d-->|"(3, 3)"|t
```
### 6. Продолжим поиск увеличивающего пути в остаточной сети
В остаточной сети не найдено увеличивающих путей, следовательно, алгоритм завершил работу и найденный поток величиной 13 является максимальным для данной сети.
### 7. Проверим значение максимального потока перебором всех разрезов сети.
Разрез сети - разбиение множества вершин на два подмножества V<sub>1</sub> и V<sub>2</sub>, где во множество V<sub>1</sub> входит источник, а в V<sub>2</sub> входит сток.
Пропускная способность разреза - сумма пропускной способности дуг, начинающихся в вершинах из множества V<sub>1</sub> и оканчивающихся в вершинах из V<sub>2</sub>.
Для сети из _n_ вершин существует 2<sup>n - 2</sup> различных разрезов, так как две вершины из множества (источник и сток) "зафиксированы" в V<sub>1</sub> и V<sub>2</sub>, остальные вершины можно различными способами распределять между множествами V<sub>1</sub> и V<sub>2</sub>.
Для сети из 6 вершин нужно найти 2<sup>6 - 2</sup> = 2<sup>4</sup> = 16 разрезов. 
| № | V<sub>1</sub>                   | V<sub>2</sub> | Пропускная способность разреза |
|---|:--------------------------------|:--------------|:------------------------------:|
| 1 | s                               | a, b, c, d, t |           8 + 8 = 16           |
| 2 | s, a                            | b, c, d, t    |         8 + 2 + 6 = 16         |
| 3 | s, b                            | a, c, d, t    |         8 + 8 + 6 + 6 = 28     |
| 4 | s, c                            | a, b, d, t    |         8 + 4 + 4 = 16         |
| 5 | s, d                            | a, b, c, t    |         8 + 8 + 9 = 25         |
| 6 | s, a, b                         | c, d, t       |         9 + 9 + 6 = 24         |
| 7 | s, a, c                         | b, d, t       |         6 + 4 + 6 = 16         |
| 8 | s, a, d                         | b, c, t       |         8 + 2 + 3 = 13         |
| 9 | s, b, c                         | a, d, t       |         8 + 6 + 6 = 20         |
| 10 | s, b, d                         | a, c, t       |         9 + 9 + 9 +10 = 37     |
| 11 | s, c, d                         | b, a, t       |         9 + 9 + 7 = 25         |
| 12 | s, a, b, c                      | d, t          |         6 + 6 + 7 = 19         |
| 13 | s, a, b, d                      | c, t          |         8 + 6 + 7 = 21         |
| 14 | s, b, c, d                      | a, t          |         9 + 9 + 9 + 2 = 29     |
| 15 | s, a, c, d                      | b, t          |         5 + 4 + 4 = 13         |
| 16 | s, a, b, c, d                   | t             |         4 + 6 + 3 = 13         |
Минимальная пропускная способность разреза равна 13 ( {s, a, b, c, d} / {t} ), что совпадает с найденной величиной максимального потока в сети.
### Ответ:
Максимальный поток в сети равен 13, он реализуется следующим локальными потоками:
```mermaid
graph LR
    s-->|"(5, 8)"|a
    s-->|"(8, 8)"|c
    a-->|"(2, 2)"|b
    a-->|"(3, 6)"|d
    c-->|"(4, 4)"|b
    c-->|"(4, 4)"|t
    b-->|"(6, 6)"|t
    d-->|"(3, 3)"|t
```
